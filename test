your_search_here
| makemv delim="," mitre_attack  
| mvexpand mitre_attack  
| eval tactic=case(
    match(mitre_attack, "^T1595(\.|$)|^T1592(\.|$)|^T1590(\.|$)|^T1591(\.|$)|^T1593(\.|$)|^T1598(\.|$)|^T1599(\.|$)"), "Reconnaissance",
    match(mitre_attack, "^T1583(\.|$)|^T1584(\.|$)|^T1585(\.|$)|^T1586(\.|$)|^T1587(\.|$)|^T1588(\.|$)|^T1589(\.|$)"), "Resource Development",
    match(mitre_attack, "^T1566(\.|$)|^T1078(\.|$)|^T1189(\.|$)|^T1190(\.|$)|^T1133(\.|$)|^T1200(\.|$)"), "Initial Access",
    match(mitre_attack, "^T1059(\.|$)|^T1203(\.|$)|^T1204(\.|$)|^T1569(\.|$)|^T1570(\.|$)"), "Execution",
    match(mitre_attack, "^T1547(\.|$)|^T1136(\.|$)|^T1098(\.|$)|^T1505(\.|$)|^T1554(\.|$)"), "Persistence",
    match(mitre_attack, "^T1548(\.|$)|^T1134(\.|$)|^T1574(\.|$)|^T1078(\.|$)|^T1611(\.|$)"), "Privilege Escalation",
    match(mitre_attack, "^T1070(\.|$)|^T1562(\.|$)|^T1202(\.|$)|^T1036(\.|$)|^T1027(\.|$)"), "Defense Evasion",
    match(mitre_attack, "^T1003(\.|$)|^T1552(\.|$)|^T1557(\.|$)|^T1110(\.|$)|^T1555(\.|$)|^T1056(\.|$)"), "Credential Access",
    match(mitre_attack, "^T1087(\.|$)|^T1010(\.|$)|^T1033(\.|$)|^T1040(\.|$)|^T1012(\.|$)|^T1069(\.|$)"), "Discovery",
    match(mitre_attack, "^T1021(\.|$)|^T1072(\.|$)|^T1534(\.|$)|^T1550(\.|$)|^T1570(\.|$)|^T1210(\.|$)"), "Lateral Movement",
    match(mitre_attack, "^T1005(\.|$)|^T1074(\.|$)|^T1113(\.|$)|^T1560(\.|$)"), "Collection",
    match(mitre_attack, "^T1071(\.|$)|^T1090(\.|$)|^T1571(\.|$)|^T1572(\.|$)|^T1573(\.|$)|^T1573(\.|$)|^T1573(\.|$)"), "Command and Control",
    match(mitre_attack, "^T1041(\.|$)|^T1567(\.|$)|^T1020(\.|$)|^T1030(\.|$)|^T1048(\.|$)"), "Exfiltration",
    match(mitre_attack, "^T1499(\.|$)|^T1485(\.|$)|^T1486(\.|$)|^T1489(\.|$)|^T1490(\.|$)|^T1498(\.|$)|^T1496(\.|$)"), "Impact",
    1=1, "Unknown"
)
| stats count by tactic  
| appendpipe [ | makeresults 
    | eval tactic="Reconnaissance,Resource Development,Initial Access,Execution,Persistence,Privilege Escalation,Defense Evasion,Credential Access,Discovery,Lateral Movement,Collection,Command and Control,Exfiltration,Impact"
    | makemv delim="," tactic 
    | mvexpand tactic 
    | eval count=0 
]
| stats max(count) as count by tactic  
| eval sort_order=case(
    tactic=="Reconnaissance", 1,
    tactic=="Resource Development", 2,
    tactic=="Initial Access", 3,
    tactic=="Execution", 4,
    tactic=="Persistence", 5,
    tactic=="Privilege Escalation", 6,
    tactic=="Defense Evasion", 7,
    tactic=="Credential Access", 8,
    tactic=="Discovery", 9,
    tactic=="Lateral Movement", 10,
    tactic=="Collection", 11,
    tactic=="Command and Control", 12,
    tactic=="Exfiltration", 13,
    tactic=="Impact", 14,
    1=1, 15
)
| sort sort_order
| eval Reconnaissance=if(tactic=="Reconnaissance", count, 0)
| eval "Resource Development"=if(tactic=="Resource Development", count, 0)
| eval "Initial Access"=if(tactic=="Initial Access", count, 0)
| eval Execution=if(tactic=="Execution", count, 0)
| eval Persistence=if(tactic=="Persistence", count, 0)
| eval "Privilege Escalation"=if(tactic=="Privilege Escalation", count, 0)
| eval "Defense Evasion"=if(tactic=="Defense Evasion", count, 0)
| eval "Credential Access"=if(tactic=="Credential Access", count, 0)
| eval Discovery=if(tactic=="Discovery", count, 0)
| eval "Lateral Movement"=if(tactic=="Lateral Movement", count, 0)
| eval Collection=if(tactic=="Collection", count, 0)
| eval "Command and Control"=if(tactic=="Command and Control", count, 0)
| eval Exfiltration=if(tactic=="Exfiltration", count, 0)
| eval Impact=if(tactic=="Impact", count, 0)
| table Reconnaissance, "Resource Development", "Initial Access", Execution, Persistence, "Privilege Escalation", "Defense Evasion", "Credential Access", Discovery, "Lateral Movement", Collection, "Command and Control", Exfiltration, Impact
